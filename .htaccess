# Disable directory browsing
Options -Indexes

# Protect .htaccess file
<Files .htaccess>
    Order Allow,Deny
    Deny from all
</Files>

# Protect source code files
<FilesMatch "\.(php|js|json|html|css)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Disable server signature
ServerSignature Off

# Prevent access to specific file types
<FilesMatch "^(README\.md|package\.json|obfuscate\.js|minify\.js|integrate-protection\.js|server\.js)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Add security headers
<IfModule mod_headers.c>
    # Prevent MIME type sniffing
    Header set X-Content-Type-Options "nosniff"
    
    # Enable XSS protection
    Header set X-XSS-Protection "1; mode=block"
    
    # Prevent clickjacking
    Header set X-Frame-Options "SAMEORIGIN"
    
    # Content Security Policy
    Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;"
    
    # Referrer Policy
    Header set Referrer-Policy "same-origin"
</IfModule>

# Prevent access to hidden files
<FilesMatch "^\.">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Prevent PHP execution in uploads directory
<Directory "uploads">
    <FilesMatch "\.php$">
        Order Allow,Deny
        Deny from all
    </FilesMatch>
</Directory>

# Redirect to HTTPS
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>
